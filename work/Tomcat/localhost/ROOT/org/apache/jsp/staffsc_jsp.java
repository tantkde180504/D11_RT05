/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/10.1.33
 * Generated at: 2025-07-14 15:15:02 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp;

import jakarta.servlet.*;
import jakarta.servlet.http.*;
import jakarta.servlet.jsp.*;

public final class staffsc_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent,
                 org.apache.jasper.runtime.JspSourceImports,
                 org.apache.jasper.runtime.JspSourceDirectives {

  private static final jakarta.servlet.jsp.JspFactory _jspxFactory =
          jakarta.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private static final java.util.Set<java.lang.String> _jspx_imports_packages;

  private static final java.util.Set<java.lang.String> _jspx_imports_classes;

  static {
    _jspx_imports_packages = new java.util.LinkedHashSet<>(4);
    _jspx_imports_packages.add("jakarta.servlet");
    _jspx_imports_packages.add("jakarta.servlet.http");
    _jspx_imports_packages.add("jakarta.servlet.jsp");
    _jspx_imports_classes = null;
  }

  private volatile jakarta.el.ExpressionFactory _el_expressionfactory;
  private volatile org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public java.util.Set<java.lang.String> getPackageImports() {
    return _jspx_imports_packages;
  }

  public java.util.Set<java.lang.String> getClassImports() {
    return _jspx_imports_classes;
  }

  public boolean getErrorOnELNotFound() {
    return false;
  }

  public jakarta.el.ExpressionFactory _jsp_getExpressionFactory() {
    if (_el_expressionfactory == null) {
      synchronized (this) {
        if (_el_expressionfactory == null) {
          _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
        }
      }
    }
    return _el_expressionfactory;
  }

  public org.apache.tomcat.InstanceManager _jsp_getInstanceManager() {
    if (_jsp_instancemanager == null) {
      synchronized (this) {
        if (_jsp_instancemanager == null) {
          _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
        }
      }
    }
    return _jsp_instancemanager;
  }

  public void _jspInit() {
  }

  public void _jspDestroy() {
  }

  public void _jspService(final jakarta.servlet.http.HttpServletRequest request, final jakarta.servlet.http.HttpServletResponse response)
      throws java.io.IOException, jakarta.servlet.ServletException {

    if (!jakarta.servlet.DispatcherType.ERROR.equals(request.getDispatcherType())) {
      final java.lang.String _jspx_method = request.getMethod();
      if ("OPTIONS".equals(_jspx_method)) {
        response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
        return;
      }
      if (!"GET".equals(_jspx_method) && !"POST".equals(_jspx_method) && !"HEAD".equals(_jspx_method)) {
        response.setHeader("Allow","GET, HEAD, POST, OPTIONS");
        response.sendError(HttpServletResponse.SC_METHOD_NOT_ALLOWED, "JSPs only permit GET, POST or HEAD. Jasper also permits OPTIONS");
        return;
      }
    }

    final jakarta.servlet.jsp.PageContext pageContext;
    jakarta.servlet.http.HttpSession session = null;
    final jakarta.servlet.ServletContext application;
    final jakarta.servlet.ServletConfig config;
    jakarta.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    jakarta.servlet.jsp.JspWriter _jspx_out = null;
    jakarta.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html; charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("<!DOCTYPE html>\r\n");
      out.write("    <html lang=\"vi\">\r\n");
      out.write("\r\n");
      out.write("    <head>\r\n");
      out.write("        <meta charset=\"UTF-8\">\r\n");
      out.write("        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n");
      out.write("        <title>Staff Dashboard - 43 Gundam Hobby</title>\r\n");
      out.write("        <!-- CSS Files -->\r\n");
      out.write("        <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\r\n");
      out.write("        <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css\" rel=\"stylesheet\">\r\n");
      out.write("        <link href=\"https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap\"\r\n");
      out.write("            rel=\"stylesheet\">\r\n");
      out.write("        <link href=\"css/styles.css\" rel=\"stylesheet\">\r\n");
      out.write("        <link href=\"css/staff-styles.css\" rel=\"stylesheet\">\r\n");
      out.write("    </head>\r\n");
      out.write("\r\n");
      out.write("    <body class=\"staff-body\">\r\n");
      out.write("        <div class=\"staff-container\">\r\n");
      out.write("            <!-- Header -->\r\n");
      out.write("            <div class=\"staff-header\">\r\n");
      out.write("                <div class=\"row align-items-center\">\r\n");
      out.write("                    <div class=\"col-md-6\">\r\n");
      out.write("                        <h1 class=\"mb-0\"><i class=\"fas fa-users-cog text-primary me-3\"></i>Staff Dashboard</h1>\r\n");
      out.write("                        <p class=\"mb-0 text-muted\">Quản lý hoạt động hỗ trợ khách hàng và vận hành</p>\r\n");
      out.write("                    </div>\r\n");
      out.write("                    <div class=\"col-md-6 text-end\">\r\n");
      out.write("                        <div class=\"d-flex align-items-center justify-content-end\">\r\n");
      out.write("                            <div class=\"me-3\">\r\n");
      out.write("                                <span class=\"text-muted\">Xin chào,</span>\r\n");
      out.write("                                <strong>Nhân viên ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${staffName}", java.lang.String.class, (jakarta.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("</strong>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"dropdown\">\r\n");
      out.write("                                <button class=\"btn btn-outline-primary dropdown-toggle\" type=\"button\"\r\n");
      out.write("                                    data-bs-toggle=\"dropdown\">\r\n");
      out.write("                                    <i class=\"fas fa-user-circle me-2\"></i>Tài khoản\r\n");
      out.write("                                </button>\r\n");
      out.write("                                <ul class=\"dropdown-menu\">\r\n");
      out.write("                                    <li><a class=\"dropdown-item\" href=\"#\"><i class=\"fas fa-user me-2\"></i>Hồ sơ</a></li>\r\n");
      out.write("                                    <li><a class=\"dropdown-item\" href=\"#\"><i class=\"fas fa-cog me-2\"></i>Cài đặt</a>\r\n");
      out.write("                                    </li>\r\n");
      out.write("                                    <li>\r\n");
      out.write("                                        <hr class=\"dropdown-divider\">\r\n");
      out.write("                                    </li>\r\n");
      out.write("                                    <li><a class=\"dropdown-item\" href=\"#\" onclick=\"logout()\"><i\r\n");
      out.write("                                                class=\"fas fa-sign-out-alt me-2\"></i>Đăng xuất</a></li>\r\n");
      out.write("                                </ul>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("            <!-- ⚠️ Cảnh báo sản phẩm sắp hết -->\r\n");
      out.write("            <div id=\"low-stock-alert\"\r\n");
      out.write("                class=\"alert alert-warning d-flex justify-content-between align-items-center mt-3 mx-3\"\r\n");
      out.write("                style=\"display: none;\">\r\n");
      out.write("\r\n");
      out.write("                <span class=\"mb-0\">\r\n");
      out.write("                    ⚠️ Có <span id=\"low-stock-count\"></span> sản phẩm <strong>sắp hết hàng</strong>.\r\n");
      out.write("                </span>\r\n");
      out.write("\r\n");
      out.write("                <a href=\"#inventory\" data-tab=\"inventory\" onclick=\"viewLowStockProducts()\"\r\n");
      out.write("                    class=\"btn btn-sm btn-outline-dark ms-3\">\r\n");
      out.write("                    Xem ngay\r\n");
      out.write("                </a>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("            <!-- Navigation -->\r\n");
      out.write("            <div class=\"staff-nav\">\r\n");
      out.write("                <ul class=\"nav nav-pills justify-content-center\">\r\n");
      out.write("                    <li class=\"nav-item\">\r\n");
      out.write("                        <a class=\"nav-link active\" href=\"#overview\" data-tab=\"overview\">\r\n");
      out.write("                            <i class=\"fas fa-chart-line me-2\"></i>Tổng quan\r\n");
      out.write("                        </a>\r\n");
      out.write("                    </li>\r\n");
      out.write("                    <li class=\"nav-item\">\r\n");
      out.write("                        <a class=\"nav-link\" href=\"#messages\" data-tab=\"messages\">\r\n");
      out.write("                            <i class=\"fas fa-comments me-2\"></i>Tin nhắn\r\n");
      out.write("                            <span class=\"notification-dot\">5</span>\r\n");
      out.write("                        </a>\r\n");
      out.write("                    </li>\r\n");
      out.write("                    <li class=\"nav-item\">\r\n");
      out.write("                        <a class=\"nav-link\" href=\"#complaints\" data-tab=\"complaints\">\r\n");
      out.write("                            <i class=\"fas fa-exclamation-triangle me-2\"></i>Khiếu nại\r\n");
      out.write("                            <span class=\"notification-dot\">3</span>\r\n");
      out.write("                        </a>\r\n");
      out.write("                    </li>\r\n");
      out.write("                    <li class=\"nav-item\">\r\n");
      out.write("                        <a class=\"nav-link\" href=\"#inventory\" data-tab=\"inventory\">\r\n");
      out.write("                            <i class=\"fas fa-boxes me-2\"></i>Tồn kho\r\n");
      out.write("                        </a>\r\n");
      out.write("                    </li>\r\n");
      out.write("                    <li class=\"nav-item\">\r\n");
      out.write("                        <a class=\"nav-link\" href=\"#returns\" data-tab=\"returns\">\r\n");
      out.write("                            <i class=\"fas fa-undo me-2\"></i>Đổi trả\r\n");
      out.write("                            <span class=\"notification-dot\">7</span>\r\n");
      out.write("                        </a>\r\n");
      out.write("                    </li>\r\n");
      out.write("                    <li class=\"nav-item\">\r\n");
      out.write("                        <a class=\"nav-link\" href=\"#orders\" data-tab=\"orders\">\r\n");
      out.write("                            <i class=\"fas fa-shopping-cart me-2\"></i>Đơn hàng\r\n");
      out.write("                        </a>\r\n");
      out.write("                    </li>\r\n");
      out.write("                    <li class=\"nav-item\">\r\n");
      out.write("                        <a class=\"nav-link\" href=\"#support\" data-tab=\"support\">\r\n");
      out.write("                            <i class=\"fas fa-life-ring me-2\"></i>Hỗ trợ\r\n");
      out.write("                        </a>\r\n");
      out.write("                    </li>\r\n");
      out.write("                </ul>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("            <!-- Overview Tab -->\r\n");
      out.write("            <div id=\"overview\" class=\"tab-content active\">\r\n");
      out.write("                <!-- Statistics Cards -->\r\n");
      out.write("                <div class=\"stats-grid\">\r\n");
      out.write("                    <div class=\"stat-card stat-card-1\">\r\n");
      out.write("                        <div class=\"icon\"><i class=\"fas fa-comments\"></i></div>\r\n");
      out.write("                        <div class=\"number\">24</div>\r\n");
      out.write("                        <div class=\"label\">Tin nhắn chờ xử lý</div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                    <div class=\"stat-card stat-card-2\">\r\n");
      out.write("                        <div class=\"icon\"><i class=\"fas fa-exclamation-triangle\"></i></div>\r\n");
      out.write("                        <div class=\"number\">8</div>\r\n");
      out.write("                        <div class=\"label\">Khiếu nại mới</div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                    <div class=\"stat-card stat-card-3\">\r\n");
      out.write("                        <div class=\"icon\"><i class=\"fas fa-undo\"></i></div>\r\n");
      out.write("                        <div class=\"number\">15</div>\r\n");
      out.write("                        <div class=\"label\">Yêu cầu đổi trả</div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                    <div class=\"stat-card stat-card-4\">\r\n");
      out.write("                        <div class=\"icon\"><i class=\"fas fa-check-circle\"></i></div>\r\n");
      out.write("                        <div class=\"number\">156</div>\r\n");
      out.write("                        <div class=\"label\">Hoàn thành hôm nay</div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("\r\n");
      out.write("                <!-- Recent Activities -->\r\n");
      out.write("                <div class=\"row\">\r\n");
      out.write("                    <div class=\"col-lg-8\">\r\n");
      out.write("                        <div class=\"staff-card\">\r\n");
      out.write("                            <h5><i class=\"fas fa-clock me-2 text-primary\"></i>Hoạt động gần đây</h5>\r\n");
      out.write("                            <div class=\"activity-list\">\r\n");
      out.write("                                <div class=\"activity-item d-flex align-items-center p-3 border-bottom\">\r\n");
      out.write("                                    <div class=\"activity-icon bg-primary text-white rounded-circle me-3\">\r\n");
      out.write("                                        <i class=\"fas fa-comment\"></i>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                    <div class=\"flex-grow-1\">\r\n");
      out.write("                                        <h6 class=\"mb-1\">Tin nhắn mới từ khách hàng</h6>\r\n");
      out.write("                                        <p class=\"mb-0 text-muted small\">Nguyễn Văn A hỏi về sản phẩm RG Strike Freedom\r\n");
      out.write("                                        </p>\r\n");
      out.write("                                        <small class=\"text-muted\">5 phút trước</small>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                                <div class=\"activity-item d-flex align-items-center p-3 border-bottom\">\r\n");
      out.write("                                    <div class=\"activity-icon bg-warning text-white rounded-circle me-3\">\r\n");
      out.write("                                        <i class=\"fas fa-exclamation\"></i>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                    <div class=\"flex-grow-1\">\r\n");
      out.write("                                        <h6 class=\"mb-1\">Khiếu nại mới</h6>\r\n");
      out.write("                                        <p class=\"mb-0 text-muted small\">Sản phẩm bị lỗi trong quá trình vận chuyển</p>\r\n");
      out.write("                                        <small class=\"text-muted\">15 phút trước</small>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                                <div class=\"activity-item d-flex align-items-center p-3 border-bottom\">\r\n");
      out.write("                                    <div class=\"activity-icon bg-info text-white rounded-circle me-3\">\r\n");
      out.write("                                        <i class=\"fas fa-undo\"></i>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                    <div class=\"flex-grow-1\">\r\n");
      out.write("                                        <h6 class=\"mb-1\">Yêu cầu đổi trả</h6>\r\n");
      out.write("                                        <p class=\"mb-0 text-muted small\">Đơn hàng #12345 yêu cầu đổi size</p>\r\n");
      out.write("                                        <small class=\"text-muted\">30 phút trước</small>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                    <div class=\"col-lg-4\">\r\n");
      out.write("                        <div class=\"staff-card\">\r\n");
      out.write("                            <h5><i class=\"fas fa-chart-pie me-2 text-primary\"></i>Thống kê hôm nay</h5>\r\n");
      out.write("                            <div class=\"chart-container\" style=\"position: relative; height: 200px; width: 100%;\">\r\n");
      out.write("                                <canvas id=\"dailyStatsChart\"></canvas>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("            <!-- Messages Tab - Real-time Chat -->\r\n");
      out.write("            <div id=\"messages\" class=\"tab-content\">\r\n");
      out.write("                <div class=\"staff-card\">\r\n");
      out.write("                    <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n");
      out.write("                        <h5><i class=\"fas fa-comments me-2 text-primary\"></i>Chat với khách hàng</h5>\r\n");
      out.write("                        <div class=\"d-flex gap-2\">\r\n");
      out.write("                            <span id=\"staff-connection-status\" class=\"badge bg-secondary\">Đang kết nối...</span>\r\n");
      out.write("                            <button class=\"btn btn-outline-primary btn-sm\" onclick=\"refreshCustomerList()\">\r\n");
      out.write("                                <i class=\"fas fa-sync-alt me-1\"></i>Làm mới\r\n");
      out.write("                            </button>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("\r\n");
      out.write("                    <div class=\"row\">\r\n");
      out.write("                        <!-- Customer List -->\r\n");
      out.write("                        <div class=\"col-lg-4\">\r\n");
      out.write("                            <div class=\"customer-list-container\">\r\n");
      out.write("                                <div class=\"search-box mb-3\">\r\n");
      out.write("                                    <i class=\"fas fa-search\"></i>\r\n");
      out.write("                                    <input type=\"text\" id=\"customer-search\" class=\"form-control\" \r\n");
      out.write("                                           placeholder=\"Tìm kiếm khách hàng...\">\r\n");
      out.write("                                </div>\r\n");
      out.write("                                \r\n");
      out.write("                                <div id=\"customer-list\" class=\"customer-list\">\r\n");
      out.write("                                    <div class=\"text-center p-3 text-muted\">\r\n");
      out.write("                                        <i class=\"fas fa-users fa-2x mb-2\"></i>\r\n");
      out.write("                                        <p>Đang tải danh sách khách hàng...</p>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        \r\n");
      out.write("                        <!-- Chat Area -->\r\n");
      out.write("                        <div class=\"col-lg-8\">\r\n");
      out.write("                            <div class=\"chat-area\">\r\n");
      out.write("                                <!-- Chat Header -->\r\n");
      out.write("                                <div id=\"chat-header\" class=\"chat-header\" style=\"display: none;\">\r\n");
      out.write("                                    <div class=\"d-flex align-items-center\">\r\n");
      out.write("                                        <div class=\"customer-avatar me-3\">\r\n");
      out.write("                                            <i class=\"fas fa-user\"></i>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                        <div>\r\n");
      out.write("                                            <h6 class=\"mb-0\" id=\"selected-customer-name\">Chọn khách hàng</h6>\r\n");
      out.write("                                            <small class=\"text-muted\" id=\"selected-customer-email\"></small>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                    <div class=\"chat-status\">\r\n");
      out.write("                                        <span class=\"badge bg-success\">Online</span>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                                \r\n");
      out.write("                                <!-- Chat Messages -->\r\n");
      out.write("                                <div id=\"staff-chat-messages\" class=\"chat-messages\">\r\n");
      out.write("                                    <div class=\"empty-chat\">\r\n");
      out.write("                                        <i class=\"fas fa-comments fa-3x text-muted mb-3\"></i>\r\n");
      out.write("                                        <h5 class=\"text-muted\">Chọn khách hàng để bắt đầu chat</h5>\r\n");
      out.write("                                        <p class=\"text-muted\">Chọn một khách hàng từ danh sách bên trái để bắt đầu hội thoại</p>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                                \r\n");
      out.write("                                <!-- Chat Input -->\r\n");
      out.write("                                <div id=\"staff-chat-input\" class=\"chat-input\" style=\"display: none;\">\r\n");
      out.write("                                    <div class=\"input-group\">\r\n");
      out.write("                                        <input type=\"text\" id=\"staff-message-input\" class=\"form-control\" \r\n");
      out.write("                                               placeholder=\"Nhập tin nhắn...\" disabled>\r\n");
      out.write("                                        <button id=\"staff-send-button\" class=\"btn btn-primary\" onclick=\"sendStaffMessage()\" disabled>\r\n");
      out.write("                                            <i class=\"fas fa-paper-plane\"></i>\r\n");
      out.write("                                        </button>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("            <!-- Complaints Tab -->\r\n");
      out.write("            <div id=\"complaints\" class=\"tab-content\">\r\n");
      out.write("                <div class=\"staff-card\">\r\n");
      out.write("                    <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n");
      out.write("                        <h5><i class=\"fas fa-exclamation-triangle me-2 text-warning\"></i>Xử lý khiếu nại</h5>\r\n");
      out.write("                        <select id=\"complaint-status-filter\" class=\"form-select auto-width\">\r\n");
      out.write("                            <option value=\"\">Tất cả khiếu nại</option>\r\n");
      out.write("                            <option value=\"PENDING\">Chờ xử lý</option>\r\n");
      out.write("                            <option value=\"PROCESSING\">Đang xử lý</option>\r\n");
      out.write("                            <option value=\"COMPLETED\">Đã hoàn thành</option>\r\n");
      out.write("                            <option value=\"REJECTED\">Từ chối</option>\r\n");
      out.write("                        </select>\r\n");
      out.write("                    </div>\r\n");
      out.write("\r\n");
      out.write("                    <div class=\"table-responsive table-modern\">\r\n");
      out.write("                        <table class=\"table table-hover\">\r\n");
      out.write("                            <thead>\r\n");
      out.write("                                <tr>\r\n");
      out.write("                                    <th>Mã khiếu nại</th>\r\n");
      out.write("                                    <th>Khách hàng</th>\r\n");
      out.write("                                    <th>Nội dung</th>\r\n");
      out.write("                                    <th>Trạng thái</th>\r\n");
      out.write("                                    <th>Ngày tạo</th>\r\n");
      out.write("                                    <th>Thao tác</th>\r\n");
      out.write("                                </tr>\r\n");
      out.write("                            </thead>\r\n");
      out.write("                            <tbody id=\"complaint-table-body\">\r\n");
      out.write("                                <!-- Dữ liệu sẽ được thêm bằng JavaScript -->\r\n");
      out.write("                            </tbody>\r\n");
      out.write("                        </table>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("            <!-- Inventory Tab -->\r\n");
      out.write("            <div id=\"inventory\" class=\"tab-content\">\r\n");
      out.write("                <div class=\"staff-card\">\r\n");
      out.write("                    <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n");
      out.write("                        <h5><i class=\"fas fa-boxes me-2 text-info\"></i>Quản lý tồn kho</h5>\r\n");
      out.write("                        <button class=\"btn btn-primary action-btn\" data-bs-toggle=\"modal\"\r\n");
      out.write("                            data-bs-target=\"#inventoryModal\">\r\n");
      out.write("                            <i class=\"fas fa-plus me-2\"></i>Cập nhật tồn kho\r\n");
      out.write("                        </button>\r\n");
      out.write("                    </div>\r\n");
      out.write("\r\n");
      out.write("                    <div class=\"row mb-4\">\r\n");
      out.write("                        <div class=\"col-md-6\">\r\n");
      out.write("                            <div class=\"search-box\">\r\n");
      out.write("                                <i class=\"fas fa-search\"></i>\r\n");
      out.write("                                <input type=\"text\" class=\"form-control\" placeholder=\"Tìm kiếm sản phẩm...\">\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"col-md-3\">\r\n");
      out.write("                            <select class=\"form-select\" id=\"category-filter\">\r\n");
      out.write("                                <option value=\"\">Tất cả danh mục</option>\r\n");
      out.write("                                <option value=\"GUNDAM_BANDAI\">GUNDAM_BANDAI</option>\r\n");
      out.write("                                <option value=\"PRE_ORDER\">PRE_ORDER</option>\r\n");
      out.write("                                <option value=\"TOOLS_ACCESSORIES\">TOOLS_ACCESSORIES</option>\r\n");
      out.write("                            </select>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"col-md-3\">\r\n");
      out.write("                            <select class=\"form-select\" id=\"status-filter\">\r\n");
      out.write("                                <option value=\"\">Tất cả trạng thái</option>\r\n");
      out.write("                                <option value=\"Còn hàng\">Còn hàng</option>\r\n");
      out.write("                                <option value=\"Sắp hết\">Sắp hết</option>\r\n");
      out.write("                                <option value=\"Hết hàng\">Hết hàng</option>\r\n");
      out.write("                            </select>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("\r\n");
      out.write("                    <div class=\"table-responsive table-modern\">\r\n");
      out.write("                        <table class=\"table table-hover\">\r\n");
      out.write("                            <thead>\r\n");
      out.write("                                <tr>\r\n");
      out.write("                                    <th>Hình ảnh</th>\r\n");
      out.write("                                    <th>Tên sản phẩm</th>\r\n");
      out.write("                                    <th>SKU</th>\r\n");
      out.write("                                    <th>Danh mục</th>\r\n");
      out.write("                                    <th>Tồn kho</th>\r\n");
      out.write("                                    <th>Trạng thái</th>\r\n");
      out.write("                                    <th>Giá</th>\r\n");
      out.write("                                    <th>Thao tác</th>\r\n");
      out.write("                                </tr>\r\n");
      out.write("                            </thead>\r\n");
      out.write("                            <tbody id=\"inventory-body\">\r\n");
      out.write("                                <!-- Dữ liệu sẽ được tải từ API bằng JavaScript -->\r\n");
      out.write("                            </tbody>\r\n");
      out.write("                        </table>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("            <!-- Returns Tab -->\r\n");
      out.write("            <div id=\"returns\" class=\"tab-content\">\r\n");
      out.write("                <div class=\"staff-card\">\r\n");
      out.write("                    <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n");
      out.write("                        <h5><i class=\"fas fa-undo me-2 text-info\"></i>Xử lý đổi trả</h5>\r\n");
      out.write("                        <select class=\"form-select auto-width\" id=\"filter-return-status\">\r\n");
      out.write("                            <option value=\"ALL\">Tất cả yêu cầu</option>\r\n");
      out.write("                            <option value=\"PROCESSING\">Chờ xử lý</option>\r\n");
      out.write("                            <option value=\"COMPLETED\">Đã xác nhận</option>\r\n");
      out.write("                        </select>\r\n");
      out.write("                    </div>\r\n");
      out.write("\r\n");
      out.write("                    <div class=\"table-responsive table-modern\">\r\n");
      out.write("                        <table class=\"table table-hover\">\r\n");
      out.write("                            <thead>\r\n");
      out.write("                                <tr>\r\n");
      out.write("                                    <th>Mã đơn hàng</th>\r\n");
      out.write("                                    <th>Khách hàng</th>\r\n");
      out.write("                                    <th>Sản phẩm</th>\r\n");
      out.write("                                    <th>Lý do</th>\r\n");
      out.write("                                    <th>Trạng thái</th>\r\n");
      out.write("                                    <th>Yêu cầu</th>\r\n");
      out.write("                                    <th>Ngày yêu cầu</th>\r\n");
      out.write("                                    <th>Thao tác</th>\r\n");
      out.write("                                </tr>\r\n");
      out.write("                            </thead>\r\n");
      out.write("                            <tbody id=\"returns-table-body\">\r\n");
      out.write("                                <!-- Nội dung sẽ được render từ JavaScript -->\r\n");
      out.write("                            </tbody>\r\n");
      out.write("                        </table>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("            <!-- Modal Chi Tiết Return -->\r\n");
      out.write("            <div class=\"modal fade\" id=\"returnModal\" tabindex=\"-1\" aria-labelledby=\"returnModalLabel\"\r\n");
      out.write("                aria-hidden=\"true\">\r\n");
      out.write("                <div class=\"modal-dialog modal-dialog-centered\">\r\n");
      out.write("                    <div class=\"modal-content\">\r\n");
      out.write("                        <div class=\"modal-header\">\r\n");
      out.write("                            <h5 class=\"modal-title\" id=\"returnModalLabel\">Chi tiết yêu cầu đổi trả</h5>\r\n");
      out.write("                            <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Đóng\"></button>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"modal-body\">\r\n");
      out.write("                            <p><strong>Mã đơn hàng:</strong> <span id=\"returnModalOrderNumber\"></span></p>\r\n");
      out.write("                            <p><strong>Khách hàng:</strong> <span id=\"returnModalUserId\"></span></p>\r\n");
      out.write("                            <p><strong>Sản phẩm:</strong> <span id=\"returnModalProductId\"></span></p>\r\n");
      out.write("                            <p><strong>Lý do:</strong> <span id=\"returnModalReason\"></span></p>\r\n");
      out.write("                            <p><strong>Yêu cầu:</strong> <span id=\"returnModalRequestType\"></span></p>\r\n");
      out.write("                            <p><strong>Trạng thái:</strong> <span id=\"returnModalStatus\"></span></p>\r\n");
      out.write("                            <p><strong>Ngày yêu cầu:</strong> <span id=\"returnModalCreatedAt\"></span></p>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"modal-footer\">\r\n");
      out.write("                            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Đóng</button>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("            <!-- Orders Tab -->\r\n");
      out.write("            <div id=\"orders\" class=\"tab-content\">\r\n");
      out.write("                <div class=\"staff-card\">\r\n");
      out.write("                    <div class=\"d-flex justify-content-between align-items-center mb-4\">\r\n");
      out.write("                        <h5><i class=\"fas fa-shopping-cart me-2 text-success\"></i>Quản lý đơn hàng</h5>\r\n");
      out.write("                        <div class=\"d-flex gap-2\">\r\n");
      out.write("                            <select id=\"order-status-filter\" class=\"form-select auto-width\"\r\n");
      out.write("                                onchange=\"loadOrdersFromAPI()\">\r\n");
      out.write("                                <option value=\"ALL\">Tất cả trạng thái</option>\r\n");
      out.write("                                <option value=\"PENDING\">Chờ xác nhận</option>\r\n");
      out.write("                                <option value=\"CONFIRMED\">Đã xác nhận</option>\r\n");
      out.write("                                <option value=\"SHIPPING\">Đang giao</option>\r\n");
      out.write("                                <option value=\"DELIVERED\">Hoàn thành</option>\r\n");
      out.write("                                <option value=\"CANCELLED\">Đã huỷ</option>\r\n");
      out.write("                            </select>\r\n");
      out.write("                            <button class=\"btn btn-primary action-btn\" data-bs-toggle=\"modal\"\r\n");
      out.write("                                data-bs-target=\"#orderModal\">\r\n");
      out.write("                                <i class=\"fas fa-plus me-2\"></i>Tạo đơn hàng\r\n");
      out.write("                            </button>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("\r\n");
      out.write("                    <div class=\"table-responsive table-modern\">\r\n");
      out.write("                        <table class=\"table table-hover\" id=\"orders-table\">\r\n");
      out.write("                            <thead>\r\n");
      out.write("                                <tr>\r\n");
      out.write("                                    <th>Mã đơn hàng</th>\r\n");
      out.write("                                    <th>Khách hàng</th>\r\n");
      out.write("                                    <th>Sản phẩm</th>\r\n");
      out.write("                                    <th>Tổng tiền</th>\r\n");
      out.write("                                    <th>Trạng thái</th>\r\n");
      out.write("                                    <th>Ngày đặt</th>\r\n");
      out.write("                                    <th>Thao tác</th>\r\n");
      out.write("                                </tr>\r\n");
      out.write("                            </thead>\r\n");
      out.write("                            <tbody id=\"orders-body\">\r\n");
      out.write("                                <!-- Dữ liệu sẽ được render từ JavaScript -->\r\n");
      out.write("                            </tbody>\r\n");
      out.write("                        </table>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("                <!-- ✅ Modal: Cập nhật trạng thái đơn hàng -->\r\n");
      out.write("                <div class=\"modal fade\" id=\"updateStatusModal\" tabindex=\"-1\">\r\n");
      out.write("                    <div class=\"modal-dialog\">\r\n");
      out.write("                        <div class=\"modal-content\">\r\n");
      out.write("                            <div class=\"modal-header\">\r\n");
      out.write("                                <h5 class=\"modal-title\">Cập nhật trạng thái đơn hàng</h5>\r\n");
      out.write("                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"modal-body\">\r\n");
      out.write("                                <input type=\"hidden\" id=\"update-order-id\">\r\n");
      out.write("                                <div class=\"mb-3\">\r\n");
      out.write("                                    <label for=\"new-status\" class=\"form-label\">Trạng thái mới:</label>\r\n");
      out.write("                                    <select class=\"form-select\" id=\"new-status\">\r\n");
      out.write("                                        <option value=\"PENDING\">Chờ xác nhận</option>\r\n");
      out.write("                                        <option value=\"CONFIRMED\">Đã xác nhận</option>\r\n");
      out.write("                                        <option value=\"SHIPPING\">Đang giao</option>\r\n");
      out.write("                                        <option value=\"DELIVERED\">Hoàn thành</option>\r\n");
      out.write("                                        <option value=\"CANCELLED\">Đã huỷ</option>\r\n");
      out.write("                                    </select>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"modal-footer\">\r\n");
      out.write("                                <button class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Đóng</button>\r\n");
      out.write("                                <button class=\"btn btn-primary\" onclick=\"updateOrderStatus()\">Lưu thay đổi</button>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("\r\n");
      out.write("                <!-- Modal xem chi tiết đơn hàng -->\r\n");
      out.write("                <div class=\"modal fade\" id=\"orderDetailModal\" tabindex=\"-1\">\r\n");
      out.write("                    <div class=\"modal-dialog modal-lg\">\r\n");
      out.write("                        <div class=\"modal-content\">\r\n");
      out.write("                            <div class=\"modal-header\">\r\n");
      out.write("                                <h5 class=\"modal-title\">Chi tiết đơn hàng</h5>\r\n");
      out.write("                                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"modal-body\">\r\n");
      out.write("                                <div id=\"order-detail-body\">\r\n");
      out.write("                                    <!-- JavaScript sẽ render nội dung tại đây -->\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"modal-footer\">\r\n");
      out.write("                                <button class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Đóng</button>\r\n");
      out.write("                                <button class=\"btn btn-outline-primary\" onclick=\"printInvoice()\">\r\n");
      out.write("                                    <i class=\"fas fa-print me-1\"></i> In hóa đơn\r\n");
      out.write("                                </button>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("\r\n");
      out.write("                <!-- Support Tab -->\r\n");
      out.write("                <div id=\"support\" class=\"tab-content\">\r\n");
      out.write("                    <div class=\"staff-card\">\r\n");
      out.write("                        <h5><i class=\"fas fa-life-ring me-2 text-primary\"></i>Hỗ trợ khách hàng</h5>\r\n");
      out.write("\r\n");
      out.write("                        <div class=\"row\">\r\n");
      out.write("                            <div class=\"col-lg-6\">\r\n");
      out.write("                                <h6><i class=\"fas fa-question-circle me-2\"></i>FAQ Quản lý</h6>\r\n");
      out.write("                                <div class=\"accordion\" id=\"faqAccordion\">\r\n");
      out.write("                                    <div class=\"accordion-item\">\r\n");
      out.write("                                        <h2 class=\"accordion-header\">\r\n");
      out.write("                                            <button class=\"accordion-button\" type=\"button\" data-bs-toggle=\"collapse\"\r\n");
      out.write("                                                data-bs-target=\"#faq1\">\r\n");
      out.write("                                                Làm thế nào để xử lý khiếu nại?\r\n");
      out.write("                                            </button>\r\n");
      out.write("                                        </h2>\r\n");
      out.write("                                        <div id=\"faq1\" class=\"accordion-collapse collapse show\"\r\n");
      out.write("                                            data-bs-parent=\"#faqAccordion\">\r\n");
      out.write("                                            <div class=\"accordion-body\">\r\n");
      out.write("                                                1. Đọc kỹ nội dung khiếu nại<br>\r\n");
      out.write("                                                2. Liên hệ khách hàng để hiểu rõ vấn đề<br>\r\n");
      out.write("                                                3. Đưa ra giải pháp phù hợp<br>\r\n");
      out.write("                                                4. Theo dõi và cập nhật trạng thái\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                    <div class=\"accordion-item\">\r\n");
      out.write("                                        <h2 class=\"accordion-header\">\r\n");
      out.write("                                            <button class=\"accordion-button collapsed\" type=\"button\"\r\n");
      out.write("                                                data-bs-toggle=\"collapse\" data-bs-target=\"#faq2\">\r\n");
      out.write("                                                Quy trình xử lý đổi trả\r\n");
      out.write("                                            </button>\r\n");
      out.write("                                        </h2>\r\n");
      out.write("                                        <div id=\"faq2\" class=\"accordion-collapse collapse\"\r\n");
      out.write("                                            data-bs-parent=\"#faqAccordion\">\r\n");
      out.write("                                            <div class=\"accordion-body\">\r\n");
      out.write("                                                1. Kiểm tra điều kiện đổi trả<br>\r\n");
      out.write("                                                2. Xác minh tình trạng sản phẩm<br>\r\n");
      out.write("                                                3. Phê duyệt hoặc từ chối yêu cầu<br>\r\n");
      out.write("                                                4. Xử lý hoàn tiền/đổi hàng\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"col-lg-6\">\r\n");
      out.write("                                <h6><i class=\"fas fa-tools me-2\"></i>Công cụ hỗ trợ</h6>\r\n");
      out.write("                                <div class=\"list-group\">\r\n");
      out.write("                                    <a href=\"#\" class=\"list-group-item list-group-item-action\">\r\n");
      out.write("                                        <i class=\"fas fa-calculator me-2\"></i>Tính toán phí vận chuyển\r\n");
      out.write("                                    </a>\r\n");
      out.write("                                    <a href=\"#\" class=\"list-group-item list-group-item-action\">\r\n");
      out.write("                                        <i class=\"fas fa-search me-2\"></i>Tra cứu đơn hàng\r\n");
      out.write("                                    </a>\r\n");
      out.write("                                    <a href=\"#\" class=\"list-group-item list-group-item-action\">\r\n");
      out.write("                                        <i class=\"fas fa-chart-bar me-2\"></i>Báo cáo thống kê\r\n");
      out.write("                                    </a>\r\n");
      out.write("                                    <a href=\"#\" class=\"list-group-item list-group-item-action\">\r\n");
      out.write("                                        <i class=\"fas fa-file-export me-2\"></i>Xuất dữ liệu\r\n");
      out.write("                                    </a>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("                <!-- Update Stock Modal -->\r\n");
      out.write("                <div class=\"modal fade\" id=\"updateStockModal\" tabindex=\"-1\" aria-hidden=\"true\">\r\n");
      out.write("                    <div class=\"modal-dialog\">\r\n");
      out.write("                        <div class=\"modal-content\">\r\n");
      out.write("                            <div class=\"modal-header\">\r\n");
      out.write("                                <h5 class=\"modal-title\"><i class=\"fas fa-edit me-2\"></i>Cập nhật số lượng</h5>\r\n");
      out.write("                                <button type=\"button\" class=\"btn-close btn-close-white\"\r\n");
      out.write("                                    data-bs-dismiss=\"modal\"></button>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"modal-body\">\r\n");
      out.write("                                <div class=\"text-center mb-4\">\r\n");
      out.write("                                    <img id=\"update-product-image\" src=\"\" class=\"rounded mb-3\" alt=\"Product\">\r\n");
      out.write("                                    <h6 id=\"update-product-name\">Tên sản phẩm</h6>\r\n");
      out.write("                                    <p class=\"text-muted\">SKU: <span id=\"update-product-sku\">---</span></p>\r\n");
      out.write("                                </div>\r\n");
      out.write("\r\n");
      out.write("                                <div class=\"mb-3\">\r\n");
      out.write("                                    <label class=\"form-label\">Số lượng hiện tại</label>\r\n");
      out.write("                                    <input type=\"number\" class=\"form-control\" id=\"current-stock\" readonly>\r\n");
      out.write("                                </div>\r\n");
      out.write("                                <div class=\"mb-3\">\r\n");
      out.write("                                    <label class=\"form-label\">Số lượng mới</label>\r\n");
      out.write("                                    <input type=\"number\" class=\"form-control\" id=\"new-stock\"\r\n");
      out.write("                                        placeholder=\"Nhập số lượng mới\">\r\n");
      out.write("                                </div>\r\n");
      out.write("                                <div class=\"mb-3\">\r\n");
      out.write("                                    <label class=\"form-label\">Lý do thay đổi</label>\r\n");
      out.write("                                    <textarea class=\"form-control\" rows=\"3\" id=\"update-reason\"\r\n");
      out.write("                                        placeholder=\"Nhập lý do...\"></textarea>\r\n");
      out.write("                                </div>\r\n");
      out.write("                                </form>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"modal-footer\">\r\n");
      out.write("                                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Hủy</button>\r\n");
      out.write("                                <button id=\"btn-update-stock\" type=\"button\" class=\"btn btn-primary\">Cập nhật</button>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("                <!-- Product Detail Modal -->\r\n");
      out.write("                <div class=\"modal fade\" id=\"productDetailModal\" tabindex=\"-1\">\r\n");
      out.write("                    <div class=\"modal-dialog modal-lg\">\r\n");
      out.write("                        <div class=\"modal-content\">\r\n");
      out.write("                            <div class=\"modal-header\">\r\n");
      out.write("                                <h5 class=\"modal-title\"><i class=\"fas fa-eye me-2\"></i>Chi tiết sản phẩm</h5>\r\n");
      out.write("                                <button type=\"button\" class=\"btn-close btn-close-white\"\r\n");
      out.write("                                    data-bs-dismiss=\"modal\"></button>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"modal-body\">\r\n");
      out.write("                                <div class=\"row\">\r\n");
      out.write("                                    <div class=\"col-md-5 text-center\">\r\n");
      out.write("                                        <img id=\"detail-product-image\" src=\"\" class=\"img-fluid rounded\"\r\n");
      out.write("                                            alt=\"Ảnh sản phẩm\">\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                    <div class=\"col-md-7\">\r\n");
      out.write("                                        <h4 id=\"detail-product-name\"></h4>\r\n");
      out.write("                                        <p><strong>SKU:</strong> <span id=\"detail-product-sku\"></span></p>\r\n");
      out.write("                                        <p><strong>Giá:</strong> <span id=\"detail-product-price\"></span></p>\r\n");
      out.write("                                        <p><strong>Danh mục:</strong> <span id=\"detail-product-category\"></span></p>\r\n");
      out.write("                                        <p><strong>Grade:</strong> <span id=\"detail-product-grade\"></span></p>\r\n");
      out.write("                                        <p><strong>Thương hiệu:</strong> <span id=\"detail-product-brand\"></span></p>\r\n");
      out.write("                                        <p><strong>Tồn kho:</strong> <span id=\"detail-product-stock\"></span></p>\r\n");
      out.write("                                        <p><strong>Mô tả:</strong><br><span id=\"detail-product-desc\"></span></p>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("            <!-- Quick Actions -->\r\n");
      out.write("            <div class=\"quick-actions\">\r\n");
      out.write("                <button class=\"quick-action-btn d-block\" title=\"Tin nhắn nhanh\" data-bs-toggle=\"modal\"\r\n");
      out.write("                    data-bs-target=\"#quickMessageModal\">\r\n");
      out.write("                    <i class=\"fas fa-comment\"></i>\r\n");
      out.write("                </button>\r\n");
      out.write("                <button class=\"quick-action-btn d-block\" title=\"Gọi điện\">\r\n");
      out.write("                    <i class=\"fas fa-phone\"></i>\r\n");
      out.write("                </button>\r\n");
      out.write("                <button class=\"quick-action-btn d-block\" title=\"Ghi chú\">\r\n");
      out.write("                    <i class=\"fas fa-sticky-note\"></i>\r\n");
      out.write("                </button>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("            <!-- Modals -->\r\n");
      out.write("            <!-- Compose Message Modal -->\r\n");
      out.write("            <div class=\"modal fade modal-modern\" id=\"composeModal\" tabindex=\"-1\">\r\n");
      out.write("                <div class=\"modal-dialog modal-lg\">\r\n");
      out.write("                    <div class=\"modal-content\">\r\n");
      out.write("                        <div class=\"modal-header\">\r\n");
      out.write("                            <h5 class=\"modal-title\"><i class=\"fas fa-edit me-2\"></i>Soạn tin nhắn mới</h5>\r\n");
      out.write("                            <button type=\"button\" class=\"btn-close btn-close-white\" data-bs-dismiss=\"modal\"></button>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"modal-body\">\r\n");
      out.write("                            <form>\r\n");
      out.write("                                <div class=\"mb-3\">\r\n");
      out.write("                                    <label class=\"form-label\">Người nhận</label>\r\n");
      out.write("                                    <input type=\"email\" class=\"form-control\" placeholder=\"email@example.com\">\r\n");
      out.write("                                </div>\r\n");
      out.write("                                <div class=\"mb-3\">\r\n");
      out.write("                                    <label class=\"form-label\">Tiêu đề</label>\r\n");
      out.write("                                    <input type=\"text\" class=\"form-control\" placeholder=\"Nhập tiêu đề...\">\r\n");
      out.write("                                </div>\r\n");
      out.write("                                <div class=\"mb-3\">\r\n");
      out.write("                                    <label class=\"form-label\">Nội dung</label>\r\n");
      out.write("                                    <textarea class=\"form-control\" rows=\"6\"\r\n");
      out.write("                                        placeholder=\"Nhập nội dung tin nhắn...\"></textarea>\r\n");
      out.write("                                </div>\r\n");
      out.write("                                <div class=\"mb-3\">\r\n");
      out.write("                                    <label class=\"form-label\">Mức độ ưu tiên</label>\r\n");
      out.write("                                    <select class=\"form-select\">\r\n");
      out.write("                                        <option>Bình thường</option>\r\n");
      out.write("                                        <option>Cao</option>\r\n");
      out.write("                                        <option>Thấp</option>\r\n");
      out.write("                                    </select>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </form>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"modal-footer\">\r\n");
      out.write("                            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Hủy</button>\r\n");
      out.write("                            <button type=\"button\" class=\"btn btn-primary\">Gửi tin nhắn</button>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("            <!-- Complaint Detail Modal -->\r\n");
      out.write("            <div class=\"modal fade modal-modern\" id=\"complaintModal\" tabindex=\"-1\">\r\n");
      out.write("                <div class=\"modal-dialog modal-xl\">\r\n");
      out.write("                    <div class=\"modal-content\">\r\n");
      out.write("                        <div class=\"modal-header\">\r\n");
      out.write("                            <h5 class=\"modal-title\">\r\n");
      out.write("                                <i class=\"fas fa-exclamation-triangle me-2\"></i>Chi tiết khiếu nại\r\n");
      out.write("                            </h5>\r\n");
      out.write("                            <button type=\"button\" class=\"btn-close btn-close-white\" data-bs-dismiss=\"modal\"></button>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"modal-body\">\r\n");
      out.write("                            <div class=\"row\">\r\n");
      out.write("                                <!-- Thông tin khiếu nại -->\r\n");
      out.write("                                <div class=\"col-md-8\">\r\n");
      out.write("                                    <div class=\"card\">\r\n");
      out.write("                                        <div class=\"card-header\">\r\n");
      out.write("                                            <h6><i class=\"fas fa-info-circle me-2\"></i>Thông tin khiếu nại</h6>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                        <div class=\"card-body\">\r\n");
      out.write("                                            <div class=\"row\">\r\n");
      out.write("                                                <div class=\"col-md-6\">\r\n");
      out.write("                                                    <p><strong>Khách hàng:</strong> <span\r\n");
      out.write("                                                            id=\"complaint-customer-name\"></span></p>\r\n");
      out.write("                                                    <p><strong>Email:</strong> <span id=\"complaint-email\"></span></p>\r\n");
      out.write("                                                    <p><strong>Điện thoại:</strong> <span id=\"complaint-phone\"></span>\r\n");
      out.write("                                                    </p>\r\n");
      out.write("                                                    <p><strong>Đơn hàng:</strong> <span\r\n");
      out.write("                                                            id=\"complaint-order-number\"></span>\r\n");
      out.write("                                                    </p>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                                <div class=\"col-md-6\">\r\n");
      out.write("                                                    <p><strong>Ngày tạo:</strong> <span\r\n");
      out.write("                                                            id=\"complaint-created-at\"></span>\r\n");
      out.write("                                                    </p>\r\n");
      out.write("                                                    <p><strong>Lí do:</strong> <span id=\"complaint-category\"></span></p>\r\n");
      out.write("                                                    <p><strong>Trạng thái:</strong> <span id=\"complaint-status\"></span>\r\n");
      out.write("                                                    </p>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            <hr>\r\n");
      out.write("                                            <h6>Nội dung khiếu nại:</h6>\r\n");
      out.write("                                            <p id=\"complaint-content\"></p>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("\r\n");
      out.write("                                <!-- Phản hồi & xử lý -->\r\n");
      out.write("                                <div class=\"col-md-4\">\r\n");
      out.write("                                    <div class=\"card\">\r\n");
      out.write("                                        <div class=\"card-header\">\r\n");
      out.write("                                            <h6><i class=\"fas fa-cog me-2\"></i>Phản hồi & giải pháp</h6>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                        <div class=\"card-body\">\r\n");
      out.write("                                            <div class=\"mb-3\">\r\n");
      out.write("                                                <label class=\"form-label\">Giải pháp</label>\r\n");
      out.write("                                                <select class=\"form-select\" id=\"complaint-solution\">\r\n");
      out.write("                                                    <option value=\"\">-- Chọn giải pháp --</option>\r\n");
      out.write("                                                    <option>Đổi sản phẩm mới</option>\r\n");
      out.write("                                                    <option>Hoàn tiền</option>\r\n");
      out.write("                                                    <option>Sửa chữa</option>\r\n");
      out.write("                                                    <option>Giảm giá đơn hàng tiếp theo</option>\r\n");
      out.write("                                                </select>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            <div class=\"mb-3\">\r\n");
      out.write("                                                <label class=\"form-label\">Phản hồi nhân viên</label>\r\n");
      out.write("                                                <textarea class=\"form-control\" id=\"complaint-staff-response\" rows=\"4\"\r\n");
      out.write("                                                    placeholder=\"Nhập phản hồi...\"></textarea>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            <div class=\"d-flex gap-2\">\r\n");
      out.write("                                                <button class=\"btn btn-success w-50\"\r\n");
      out.write("                                                    onclick=\"handleComplaintUpdate('PROCESSING')\">\r\n");
      out.write("                                                    <i class=\"fas fa-check me-1\"></i>Phê duyệt\r\n");
      out.write("                                                </button>\r\n");
      out.write("                                                <button class=\"btn btn-danger w-50\"\r\n");
      out.write("                                                    onclick=\"handleComplaintUpdate('REJECTED')\">\r\n");
      out.write("                                                    <i class=\"fas fa-times me-1\"></i>Từ chối\r\n");
      out.write("                                                </button>\r\n");
      out.write("                                            </div>\r\n");
      out.write("\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("            <!-- Inventory Update Modal -->\r\n");
      out.write("            <div class=\"modal fade modal-modern\" id=\"inventoryModal\" tabindex=\"-1\">\r\n");
      out.write("                <div class=\"modal-dialog modal-lg\">\r\n");
      out.write("                    <div class=\"modal-content\">\r\n");
      out.write("                        <div class=\"modal-header\">\r\n");
      out.write("                            <h5 class=\"modal-title\"><i class=\"fas fa-plus me-2\"></i>Cập nhật tồn kho</h5>\r\n");
      out.write("                            <button type=\"button\" class=\"btn-close btn-close-white\" data-bs-dismiss=\"modal\"></button>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"modal-body\">\r\n");
      out.write("                            <form>\r\n");
      out.write("                                <div class=\"row\">\r\n");
      out.write("                                    <div class=\"col-md-6\">\r\n");
      out.write("                                        <div class=\"mb-3\">\r\n");
      out.write("                                            <label class=\"form-label\">Sản phẩm</label>\r\n");
      out.write("                                            <select class=\"form-select\">\r\n");
      out.write("                                                <option>Chọn sản phẩm...</option>\r\n");
      out.write("                                                <option>RG Strike Freedom Gundam</option>\r\n");
      out.write("                                                <option>MG Barbatos</option>\r\n");
      out.write("                                                <option>PG Unicorn Gundam</option>\r\n");
      out.write("                                            </select>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                        <div class=\"mb-3\">\r\n");
      out.write("                                            <label class=\"form-label\">Loại cập nhật</label>\r\n");
      out.write("                                            <select class=\"form-select\">\r\n");
      out.write("                                                <option>Nhập kho</option>\r\n");
      out.write("                                                <option>Xuất kho</option>\r\n");
      out.write("                                                <option>Điều chỉnh</option>\r\n");
      out.write("                                                <option>Kiểm kê</option>\r\n");
      out.write("                                            </select>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                        <div class=\"mb-3\">\r\n");
      out.write("                                            <label class=\"form-label\">Số lượng</label>\r\n");
      out.write("                                            <input type=\"number\" class=\"form-control\" placeholder=\"0\">\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                    <div class=\"col-md-6\">\r\n");
      out.write("                                        <div class=\"mb-3\">\r\n");
      out.write("                                            <label class=\"form-label\">Lý do</label>\r\n");
      out.write("                                            <select class=\"form-select\">\r\n");
      out.write("                                                <option>Nhập hàng mới</option>\r\n");
      out.write("                                                <option>Bán hàng</option>\r\n");
      out.write("                                                <option>Hàng lỗi</option>\r\n");
      out.write("                                                <option>Mất mát</option>\r\n");
      out.write("                                                <option>Khác</option>\r\n");
      out.write("                                            </select>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                        <div class=\"mb-3\">\r\n");
      out.write("                                            <label class=\"form-label\">Ghi chú</label>\r\n");
      out.write("                                            <textarea class=\"form-control\" rows=\"3\"\r\n");
      out.write("                                                placeholder=\"Nhập ghi chú...\"></textarea>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                        <div class=\"mb-3\">\r\n");
      out.write("                                            <label class=\"form-label\">Ngày hiệu lực</label>\r\n");
      out.write("                                            <input type=\"date\" class=\"form-control\" value=\"2024-03-15\">\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </form>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"modal-footer\">\r\n");
      out.write("                            <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Hủy</button>\r\n");
      out.write("                            <button type=\"button\" class=\"btn btn-primary\">Cập nhật tồn kho</button>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("            </div>\r\n");
      out.write("\r\n");
      out.write("\r\n");
      out.write("            <!-- Return Detail Modal -->\r\n");
      out.write("            <div class=\"modal fade modal-modern\" id=\"returnModal\" tabindex=\"-1\">\r\n");
      out.write("                <div class=\"modal-dialog modal-lg\">\r\n");
      out.write("                    <div class=\"modal-content\">\r\n");
      out.write("                        <div class=\"modal-header\">\r\n");
      out.write("                            <h5 class=\"modal-title\"><i class=\"fas fa-undo me-2\"></i>Chi tiết yêu cầu đổi trả #12345</h5>\r\n");
      out.write("                            <button type=\"button\" class=\"btn-close btn-close-white\" data-bs-dismiss=\"modal\"></button>\r\n");
      out.write("                        </div>\r\n");
      out.write("                        <div class=\"modal-body\">\r\n");
      out.write("                            <div class=\"row\">\r\n");
      out.write("                                <div class=\"col-md-8\">\r\n");
      out.write("                                    <div class=\"card\">\r\n");
      out.write("                                        <div class=\"card-header\">\r\n");
      out.write("                                            <h6><i class=\"fas fa-shopping-cart me-2\"></i>Thông tin đơn hàng</h6>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                        <div class=\"card-body\">\r\n");
      out.write("                                            <div class=\"row\">\r\n");
      out.write("                                                <div class=\"col-md-6\">\r\n");
      out.write("                                                    <p><strong>Mã đơn hàng:</strong> #12345</p>\r\n");
      out.write("                                                    <p><strong>Khách hàng:</strong> Nguyễn Văn A</p>\r\n");
      out.write("                                                    <p><strong>Email:</strong> customer@email.com</p>\r\n");
      out.write("                                                    <p><strong>Sản phẩm:</strong> RG Strike Freedom Gundam</p>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                                <div class=\"col-md-6\">\r\n");
      out.write("                                                    <p><strong>Ngày mua:</strong> 10/03/2024</p>\r\n");
      out.write("                                                    <p><strong>Ngày yêu cầu:</strong> 15/03/2024</p>\r\n");
      out.write("                                                    <p><strong>Giá trị:</strong> 850,000₫</p>\r\n");
      out.write("                                                    <p><strong>Trạng thái:</strong> <span\r\n");
      out.write("                                                            class=\"status-badge status-pending\">Chờ xử lý</span></p>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            <hr>\r\n");
      out.write("                                            <h6>Lý do đổi trả:</h6>\r\n");
      out.write("                                            <p>Sản phẩm bị lỗi khi nhận hàng. Một số chi tiết bị gãy và hộp bị móp méo.\r\n");
      out.write("                                            </p>\r\n");
      out.write("\r\n");
      out.write("                                            <h6 class=\"mt-3\">Hình ảnh:</h6>\r\n");
      out.write("                                            <div class=\"d-flex gap-2\">\r\n");
      out.write("                                                <img src=\"https://via.placeholder.com/80x80\" class=\"rounded\"\r\n");
      out.write("                                                    alt=\"Return evidence\">\r\n");
      out.write("                                                <img src=\"https://via.placeholder.com/80x80\" class=\"rounded\"\r\n");
      out.write("                                                    alt=\"Return evidence\">\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                                <div class=\"col-md-4\">\r\n");
      out.write("                                    <div class=\"card\">\r\n");
      out.write("                                        <div class=\"card-header\">\r\n");
      out.write("                                            <h6><i class=\"fas fa-cogs me-2\"></i>Xử lý yêu cầu</h6>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                        <div class=\"card-body\">\r\n");
      out.write("                                            <form>\r\n");
      out.write("                                                <div class=\"mb-3\">\r\n");
      out.write("                                                    <label class=\"form-label\">Quyết định</label>\r\n");
      out.write("                                                    <select class=\"form-select\">\r\n");
      out.write("                                                        <option>Chọn quyết định...</option>\r\n");
      out.write("                                                        <option>Phê duyệt đổi hàng</option>\r\n");
      out.write("                                                        <option>Phê duyệt hoàn tiền</option>\r\n");
      out.write("                                                        <option>Từ chối</option>\r\n");
      out.write("                                                        <option>Yêu cầu thêm thông tin</option>\r\n");
      out.write("                                                    </select>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                                <div class=\"mb-3\">\r\n");
      out.write("                                                    <label class=\"form-label\">Ghi chú</label>\r\n");
      out.write("                                                    <textarea class=\"form-control\" rows=\"4\"\r\n");
      out.write("                                                        placeholder=\"Nhập ghi chú xử lý...\"></textarea>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                                <div class=\"mb-3\">\r\n");
      out.write("                                                    <label class=\"form-label\">Phí xử lý</label>\r\n");
      out.write("                                                    <input type=\"number\" class=\"form-control\" placeholder=\"0\" value=\"0\">\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                                <button type=\"button\" class=\"btn btn-success w-100 mb-2\">Phê\r\n");
      out.write("                                                    duyệt</button>\r\n");
      out.write("                                                <button type=\"button\" class=\"btn btn-danger w-100\">Từ chối</button>\r\n");
      out.write("                                            </form>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("\r\n");
      out.write("                <!-- Order Detail Modal -->\r\n");
      out.write("                <div class=\"modal fade modal-modern\" id=\"orderDetailModal\" tabindex=\"-1\">\r\n");
      out.write("                    <div class=\"modal-dialog modal-xl\">\r\n");
      out.write("                        <div class=\"modal-content\">\r\n");
      out.write("                            <div class=\"modal-header\">\r\n");
      out.write("                                <h5 class=\"modal-title\"><i class=\"fas fa-shopping-cart me-2\"></i>Chi tiết đơn hàng\r\n");
      out.write("                                    #ORD001</h5>\r\n");
      out.write("                                <button type=\"button\" class=\"btn-close btn-close-white\"\r\n");
      out.write("                                    data-bs-dismiss=\"modal\"></button>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"modal-body\">\r\n");
      out.write("                                <div class=\"row\">\r\n");
      out.write("                                    <div class=\"col-md-8\">\r\n");
      out.write("                                        <div class=\"card\">\r\n");
      out.write("                                            <div class=\"card-header\">\r\n");
      out.write("                                                <h6><i class=\"fas fa-list me-2\"></i>Sản phẩm trong đơn hàng</h6>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            <div class=\"card-body\">\r\n");
      out.write("                                                <div class=\"table-responsive\">\r\n");
      out.write("                                                    <table class=\"table table-sm\">\r\n");
      out.write("                                                        <thead>\r\n");
      out.write("                                                            <tr>\r\n");
      out.write("                                                                <th>Sản phẩm</th>\r\n");
      out.write("                                                                <th>SKU</th>\r\n");
      out.write("                                                                <th>Số lượng</th>\r\n");
      out.write("                                                                <th>Đơn giá</th>\r\n");
      out.write("                                                                <th>Thành tiền</th>\r\n");
      out.write("                                                            </tr>\r\n");
      out.write("                                                        </thead>\r\n");
      out.write("                                                        <tbody>\r\n");
      out.write("                                                            <tr>\r\n");
      out.write("                                                                <td>\r\n");
      out.write("                                                                    <div class=\"d-flex align-items-center\">\r\n");
      out.write("                                                                        <img src=\"https://via.placeholder.com/40x40\"\r\n");
      out.write("                                                                            class=\"rounded me-2\">\r\n");
      out.write("                                                                        <span>RG Strike Freedom Gundam</span>\r\n");
      out.write("                                                                    </div>\r\n");
      out.write("                                                                </td>\r\n");
      out.write("                                                                <td>RG-001</td>\r\n");
      out.write("                                                                <td>1</td>\r\n");
      out.write("                                                                <td>850,000₫</td>\r\n");
      out.write("                                                                <td>850,000₫</td>\r\n");
      out.write("                                                            </tr>\r\n");
      out.write("                                                            <tr>\r\n");
      out.write("                                                                <td>\r\n");
      out.write("                                                                    <div class=\"d-flex align-items-center\">\r\n");
      out.write("                                                                        <img src=\"https://via.placeholder.com/40x40\"\r\n");
      out.write("                                                                            class=\"rounded me-2\">\r\n");
      out.write("                                                                        <span>Gundam Panel Line Marker</span>\r\n");
      out.write("                                                                    </div>\r\n");
      out.write("                                                                </td>\r\n");
      out.write("                                                                <td>TOOL-001</td>\r\n");
      out.write("                                                                <td>1</td>\r\n");
      out.write("                                                                <td>100,000₫</td>\r\n");
      out.write("                                                                <td>100,000₫</td>\r\n");
      out.write("                                                            </tr>\r\n");
      out.write("                                                        </tbody>\r\n");
      out.write("                                                    </table>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                                <hr>\r\n");
      out.write("                                                <div class=\"row\">\r\n");
      out.write("                                                    <div class=\"col-md-6\">\r\n");
      out.write("                                                        <h6>Thông tin khách hàng:</h6>\r\n");
      out.write("                                                        <p><strong>Tên:</strong> Nguyễn Văn A</p>\r\n");
      out.write("                                                        <p><strong>Email:</strong> customer@email.com</p>\r\n");
      out.write("                                                        <p><strong>Điện thoại:</strong> 0123456789</p>\r\n");
      out.write("                                                    </div>\r\n");
      out.write("                                                    <div class=\"col-md-6\">\r\n");
      out.write("                                                        <h6>Địa chỉ giao hàng:</h6>\r\n");
      out.write("                                                        <p>123 Đường ABC, Quận 1<br>TP. Hồ Chí Minh<br>Việt Nam</p>\r\n");
      out.write("                                                    </div>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                    <div class=\"col-md-4\">\r\n");
      out.write("                                        <div class=\"card\">\r\n");
      out.write("                                            <div class=\"card-header\">\r\n");
      out.write("                                                <h6><i class=\"fas fa-info-circle me-2\"></i>Thông tin đơn hàng</h6>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            <div class=\"card-body\">\r\n");
      out.write("                                                <p><strong>Mã đơn hàng:</strong> #ORD001</p>\r\n");
      out.write("                                                <p><strong>Ngày đặt:</strong> 15/03/2024</p>\r\n");
      out.write("                                                <p><strong>Trạng thái:</strong> <span\r\n");
      out.write("                                                        class=\"status-badge status-pending\">Chờ xác nhận</span></p>\r\n");
      out.write("                                                <p><strong>Phương thức thanh toán:</strong> COD</p>\r\n");
      out.write("                                                <hr>\r\n");
      out.write("                                                <div class=\"d-flex justify-content-between\">\r\n");
      out.write("                                                    <span>Tạm tính:</span>\r\n");
      out.write("                                                    <span>950,000₫</span>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                                <div class=\"d-flex justify-content-between\">\r\n");
      out.write("                                                    <span>Phí vận chuyển:</span>\r\n");
      out.write("                                                    <span>0₫</span>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                                <div class=\"d-flex justify-content-between\">\r\n");
      out.write("                                                    <span>Giảm giá:</span>\r\n");
      out.write("                                                    <span>0₫</span>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                                <hr>\r\n");
      out.write("                                                <div class=\"d-flex justify-content-between\">\r\n");
      out.write("                                                    <strong>Tổng cộng:</strong>\r\n");
      out.write("                                                    <strong>950,000₫</strong>\r\n");
      out.write("                                                </div>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                        </div>\r\n");
      out.write("\r\n");
      out.write("                                        <div class=\"card mt-3\">\r\n");
      out.write("                                            <div class=\"card-header\">\r\n");
      out.write("                                                <h6><i class=\"fas fa-truck me-2\"></i>Cập nhật trạng thái</h6>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            <div class=\"card-body\">\r\n");
      out.write("                                                <form>\r\n");
      out.write("                                                    <div class=\"mb-3\">\r\n");
      out.write("                                                        <label class=\"form-label\">Trạng thái mới</label>\r\n");
      out.write("                                                        <select class=\"form-select\">\r\n");
      out.write("                                                            <option>Chờ xác nhận</option>\r\n");
      out.write("                                                            <option>Đã xác nhận</option>\r\n");
      out.write("                                                            <option>Đang chuẩn bị</option>\r\n");
      out.write("                                                            <option>Đang giao</option>\r\n");
      out.write("                                                            <option>Hoàn thành</option>\r\n");
      out.write("                                                            <option>Đã hủy</option>\r\n");
      out.write("                                                        </select>\r\n");
      out.write("                                                    </div>\r\n");
      out.write("                                                    <div class=\"mb-3\">\r\n");
      out.write("                                                        <label class=\"form-label\">Ghi chú</label>\r\n");
      out.write("                                                        <textarea class=\"form-control\" rows=\"3\"\r\n");
      out.write("                                                            placeholder=\"Ghi chú cập nhật...\"></textarea>\r\n");
      out.write("                                                    </div>\r\n");
      out.write("                                                    <button type=\"button\" class=\"btn btn-primary w-100\">Cập nhật trạng\r\n");
      out.write("                                                        thái</button>\r\n");
      out.write("                                                </form>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("\r\n");
      out.write("                <!-- Create Order Modal -->\r\n");
      out.write("                <div class=\"modal fade modal-modern\" id=\"orderModal\" tabindex=\"-1\">\r\n");
      out.write("                    <div class=\"modal-dialog modal-lg\">\r\n");
      out.write("                        <div class=\"modal-content\">\r\n");
      out.write("                            <div class=\"modal-header\">\r\n");
      out.write("                                <h5 class=\"modal-title\"><i class=\"fas fa-plus me-2\"></i>Tạo đơn hàng mới</h5>\r\n");
      out.write("                                <button type=\"button\" class=\"btn-close btn-close-white\"\r\n");
      out.write("                                    data-bs-dismiss=\"modal\"></button>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"modal-body\">\r\n");
      out.write("                                <form>\r\n");
      out.write("                                    <div class=\"row\">\r\n");
      out.write("                                        <div class=\"col-md-6\">\r\n");
      out.write("                                            <h6><i class=\"fas fa-user me-2\"></i>Thông tin khách hàng</h6>\r\n");
      out.write("                                            <div class=\"mb-3\">\r\n");
      out.write("                                                <label class=\"form-label\">Họ tên</label>\r\n");
      out.write("                                                <input type=\"text\" class=\"form-control\" placeholder=\"Nhập họ tên...\">\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            <div class=\"mb-3\">\r\n");
      out.write("                                                <label class=\"form-label\">Email</label>\r\n");
      out.write("                                                <input type=\"email\" class=\"form-control\"\r\n");
      out.write("                                                    placeholder=\"email@example.com\">\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            <div class=\"mb-3\">\r\n");
      out.write("                                                <label class=\"form-label\">Điện thoại</label>\r\n");
      out.write("                                                <input type=\"tel\" class=\"form-control\" placeholder=\"0123456789\">\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            <div class=\"mb-3\">\r\n");
      out.write("                                                <label class=\"form-label\">Địa chỉ</label>\r\n");
      out.write("                                                <textarea class=\"form-control\" rows=\"3\"\r\n");
      out.write("                                                    placeholder=\"Nhập địa chỉ giao hàng...\"></textarea>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                        <div class=\"col-md-6\">\r\n");
      out.write("                                            <h6><i class=\"fas fa-box me-2\"></i>Sản phẩm</h6>\r\n");
      out.write("                                            <div class=\"mb-3\">\r\n");
      out.write("                                                <label class=\"form-label\">Chọn sản phẩm</label>\r\n");
      out.write("                                                <select class=\"form-select\">\r\n");
      out.write("                                                    <option>Chọn sản phẩm...</option>\r\n");
      out.write("                                                    <option>RG Strike Freedom Gundam - 850,000₫</option>\r\n");
      out.write("                                                    <option>MG Barbatos - 1,200,000₫</option>\r\n");
      out.write("                                                    <option>PG Unicorn Gundam - 4,500,000₫</option>\r\n");
      out.write("                                                </select>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            <div class=\"mb-3\">\r\n");
      out.write("                                                <label class=\"form-label\">Số lượng</label>\r\n");
      out.write("                                                <input type=\"number\" class=\"form-control\" value=\"1\" min=\"1\">\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            <div class=\"mb-3\">\r\n");
      out.write("                                                <label class=\"form-label\">Phương thức thanh toán</label>\r\n");
      out.write("                                                <select class=\"form-select\">\r\n");
      out.write("                                                    <option>COD (Thanh toán khi nhận hàng)</option>\r\n");
      out.write("                                                    <option>Chuyển khoản</option>\r\n");
      out.write("                                                    <option>Ví điện tử</option>\r\n");
      out.write("                                                </select>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                            <div class=\"mb-3\">\r\n");
      out.write("                                                <label class=\"form-label\">Ghi chú</label>\r\n");
      out.write("                                                <textarea class=\"form-control\" rows=\"3\"\r\n");
      out.write("                                                    placeholder=\"Ghi chú đơn hàng...\"></textarea>\r\n");
      out.write("                                            </div>\r\n");
      out.write("                                        </div>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </form>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"modal-footer\">\r\n");
      out.write("                                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Hủy</button>\r\n");
      out.write("                                <button type=\"button\" class=\"btn btn-primary\">Tạo đơn hàng</button>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div>\r\n");
      out.write("\r\n");
      out.write("                <!-- Quick Message Modal -->\r\n");
      out.write("                <div class=\"modal fade modal-modern\" id=\"quickMessageModal\" tabindex=\"-1\">\r\n");
      out.write("                    <div class=\"modal-dialog\">\r\n");
      out.write("                        <div class=\"modal-content\">\r\n");
      out.write("                            <div class=\"modal-header\">\r\n");
      out.write("                                <h5 class=\"modal-title\"><i class=\"fas fa-bolt me-2\"></i>Tin nhắn nhanh</h5>\r\n");
      out.write("                                <button type=\"button\" class=\"btn-close btn-close-white\"\r\n");
      out.write("                                    data-bs-dismiss=\"modal\"></button>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"modal-body\">\r\n");
      out.write("                                <form>\r\n");
      out.write("                                    <div class=\"mb-3\">\r\n");
      out.write("                                        <label class=\"form-label\">Mẫu tin nhắn</label>\r\n");
      out.write("                                        <select class=\"form-select\" id=\"messageTemplate\">\r\n");
      out.write("                                            <option value=\"\">Chọn mẫu tin nhắn...</option>\r\n");
      out.write("                                            <option value=\"order_confirm\">Xác nhận đơn hàng</option>\r\n");
      out.write("                                            <option value=\"shipping_info\">Thông tin vận chuyển</option>\r\n");
      out.write("                                            <option value=\"thank_you\">Cảm ơn khách hàng</option>\r\n");
      out.write("                                            <option value=\"follow_up\">Theo dõi sau bán hàng</option>\r\n");
      out.write("                                        </select>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                    <div class=\"mb-3\">\r\n");
      out.write("                                        <label class=\"form-label\">Người nhận</label>\r\n");
      out.write("                                        <input type=\"email\" class=\"form-control\" placeholder=\"email@example.com\">\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                    <div class=\"mb-3\">\r\n");
      out.write("                                        <label class=\"form-label\">Nội dung</label>\r\n");
      out.write("                                        <textarea class=\"form-control\" rows=\"5\" id=\"messageContent\"\r\n");
      out.write("                                            placeholder=\"Nhập nội dung tin nhắn...\"></textarea>\r\n");
      out.write("                                    </div>\r\n");
      out.write("                                </form>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"modal-footer\">\r\n");
      out.write("                                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Hủy</button>\r\n");
      out.write("                                <button type=\"button\" class=\"btn btn-primary\">Gửi tin nhắn</button>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    </div>\r\n");
      out.write("                </div> <!-- Scripts -->\r\n");
      out.write("                <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js\"></script>\r\n");
      out.write("                <script src=\"https://cdn.jsdelivr.net/npm/chart.js\"></script>\r\n");
      out.write("                <script src=\"js/staff.js\"></script>\r\n");
      out.write("                <script src=\"");
      out.print(request.getContextPath());
      out.write("/js/auth.js\"></script>\r\n");
      out.write("                \r\n");
      out.write("                <!-- Chat WebSocket Scripts -->\r\n");
      out.write("                <script src=\"https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.5.1/sockjs.min.js\"></script>\r\n");
      out.write("                <script src=\"https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js\"></script>\r\n");
      out.write("\r\n");
      out.write("                <style>\r\n");
      out.write("                /* Staff Chat Styles */\r\n");
      out.write("                .customer-list-container {\r\n");
      out.write("                    border: 1px solid #e0e0e0;\r\n");
      out.write("                    border-radius: 8px;\r\n");
      out.write("                    height: 500px;\r\n");
      out.write("                    overflow: hidden;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .customer-list {\r\n");
      out.write("                    height: calc(100% - 60px);\r\n");
      out.write("                    overflow-y: auto;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .customer-item {\r\n");
      out.write("                    padding: 12px 15px;\r\n");
      out.write("                    border-bottom: 1px solid #f0f0f0;\r\n");
      out.write("                    cursor: pointer;\r\n");
      out.write("                    transition: all 0.2s ease;\r\n");
      out.write("                    display: flex;\r\n");
      out.write("                    align-items: center;\r\n");
      out.write("                    gap: 10px;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .customer-item:hover {\r\n");
      out.write("                    background-color: #f8f9fa;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .customer-item.active {\r\n");
      out.write("                    background-color: #007bff;\r\n");
      out.write("                    color: white;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .customer-item.active .text-muted {\r\n");
      out.write("                    color: rgba(255, 255, 255, 0.8) !important;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .customer-avatar {\r\n");
      out.write("                    width: 40px;\r\n");
      out.write("                    height: 40px;\r\n");
      out.write("                    background: #007bff;\r\n");
      out.write("                    border-radius: 50%;\r\n");
      out.write("                    display: flex;\r\n");
      out.write("                    align-items: center;\r\n");
      out.write("                    justify-content: center;\r\n");
      out.write("                    color: white;\r\n");
      out.write("                    flex-shrink: 0;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .customer-item.active .customer-avatar {\r\n");
      out.write("                    background: rgba(255, 255, 255, 0.2);\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .customer-info {\r\n");
      out.write("                    flex: 1;\r\n");
      out.write("                    min-width: 0;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .customer-info h6 {\r\n");
      out.write("                    margin: 0;\r\n");
      out.write("                    font-size: 14px;\r\n");
      out.write("                    font-weight: 600;\r\n");
      out.write("                    white-space: nowrap;\r\n");
      out.write("                    overflow: hidden;\r\n");
      out.write("                    text-overflow: ellipsis;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .customer-info small {\r\n");
      out.write("                    font-size: 12px;\r\n");
      out.write("                    opacity: 0.8;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .unread-indicator {\r\n");
      out.write("                    width: 8px;\r\n");
      out.write("                    height: 8px;\r\n");
      out.write("                    background: #dc3545;\r\n");
      out.write("                    border-radius: 50%;\r\n");
      out.write("                    flex-shrink: 0;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .chat-area {\r\n");
      out.write("                    border: 1px solid #e0e0e0;\r\n");
      out.write("                    border-radius: 8px;\r\n");
      out.write("                    height: 500px;\r\n");
      out.write("                    display: flex;\r\n");
      out.write("                    flex-direction: column;\r\n");
      out.write("                    overflow: hidden;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .chat-header {\r\n");
      out.write("                    padding: 15px 20px;\r\n");
      out.write("                    border-bottom: 1px solid #e0e0e0;\r\n");
      out.write("                    background: #f8f9fa;\r\n");
      out.write("                    display: flex;\r\n");
      out.write("                    justify-content: space-between;\r\n");
      out.write("                    align-items: center;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .chat-messages {\r\n");
      out.write("                    flex: 1;\r\n");
      out.write("                    padding: 15px;\r\n");
      out.write("                    overflow-y: auto;\r\n");
      out.write("                    overflow-x: hidden;\r\n");
      out.write("                    background: #fafafa;\r\n");
      out.write("                    max-height: 350px;\r\n");
      out.write("                    scroll-behavior: smooth;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                /* Custom scrollbar cho staff chat */\r\n");
      out.write("                .chat-messages::-webkit-scrollbar {\r\n");
      out.write("                    width: 8px;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .chat-messages::-webkit-scrollbar-track {\r\n");
      out.write("                    background: #f1f1f1;\r\n");
      out.write("                    border-radius: 4px;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .chat-messages::-webkit-scrollbar-thumb {\r\n");
      out.write("                    background: #c1c1c1;\r\n");
      out.write("                    border-radius: 4px;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .chat-messages::-webkit-scrollbar-thumb:hover {\r\n");
      out.write("                    background: #a8a8a8;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .chat-messages::after {\r\n");
      out.write("                    content: \"\";\r\n");
      out.write("                    display: table;\r\n");
      out.write("                    clear: both;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .empty-chat {\r\n");
      out.write("                    height: 100%;\r\n");
      out.write("                    display: flex;\r\n");
      out.write("                    flex-direction: column;\r\n");
      out.write("                    align-items: center;\r\n");
      out.write("                    justify-content: center;\r\n");
      out.write("                    text-align: center;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .staff-message {\r\n");
      out.write("                    margin-bottom: 15px;\r\n");
      out.write("                    display: flex;\r\n");
      out.write("                    gap: 10px;\r\n");
      out.write("                    width: 100%;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .staff-message.sent {\r\n");
      out.write("                    flex-direction: row-reverse;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .staff-message.sent .message-bubble {\r\n");
      out.write("                    background: #007bff;\r\n");
      out.write("                    color: white;\r\n");
      out.write("                    border-radius: 18px 18px 4px 18px;\r\n");
      out.write("                    float: right;\r\n");
      out.write("                    clear: both;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .staff-message.received .message-bubble {\r\n");
      out.write("                    background: white;\r\n");
      out.write("                    color: #333;\r\n");
      out.write("                    border: 1px solid #e0e0e0;\r\n");
      out.write("                    border-radius: 18px 18px 18px 4px;\r\n");
      out.write("                    float: left;\r\n");
      out.write("                    clear: both;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .message-bubble {\r\n");
      out.write("                    max-width: 85%;\r\n");
      out.write("                    padding: 12px 16px;\r\n");
      out.write("                    word-wrap: break-word;\r\n");
      out.write("                    word-break: break-word;\r\n");
      out.write("                    overflow-wrap: break-word;\r\n");
      out.write("                    white-space: pre-wrap;\r\n");
      out.write("                    font-size: 14px;\r\n");
      out.write("                    line-height: 1.4;\r\n");
      out.write("                    display: inline-block;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .message-time {\r\n");
      out.write("                    font-size: 11px;\r\n");
      out.write("                    color: #999;\r\n");
      out.write("                    margin-top: 6px;\r\n");
      out.write("                    text-align: center;\r\n");
      out.write("                    font-style: italic;\r\n");
      out.write("                    opacity: 0.7;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .chat-input {\r\n");
      out.write("                    padding: 15px 20px;\r\n");
      out.write("                    border-top: 1px solid #e0e0e0;\r\n");
      out.write("                    background: white;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .chat-input .input-group {\r\n");
      out.write("                    gap: 10px;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .chat-input input {\r\n");
      out.write("                    border-radius: 20px;\r\n");
      out.write("                    border: 1px solid #ddd;\r\n");
      out.write("                    padding: 10px 15px;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                .chat-input button {\r\n");
      out.write("                    border-radius: 50%;\r\n");
      out.write("                    width: 40px;\r\n");
      out.write("                    height: 40px;\r\n");
      out.write("                    display: flex;\r\n");
      out.write("                    align-items: center;\r\n");
      out.write("                    justify-content: center;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                #staff-connection-status.bg-success {\r\n");
      out.write("                    background-color: #28a745 !important;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                #staff-connection-status.bg-warning {\r\n");
      out.write("                    background-color: #ffc107 !important;\r\n");
      out.write("                    color: #212529 !important;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                #staff-connection-status.bg-danger {\r\n");
      out.write("                    background-color: #dc3545 !important;\r\n");
      out.write("                }\r\n");
      out.write("                </style>\r\n");
      out.write("\r\n");
      out.write("                <script>\r\n");
      out.write("                let staffStompClient = null;\r\n");
      out.write("                let staffCurrentUserId = null;\r\n");
      out.write("                let staffCurrentUserType = 'STAFF';\r\n");
      out.write("                let selectedCustomerId = null;\r\n");
      out.write("                let customerListData = [];\r\n");
      out.write("\r\n");
      out.write("                // Khởi tạo staff chat\r\n");
      out.write("                function initStaffChat(userId, userType) {\r\n");
      out.write("                    staffCurrentUserId = userId;\r\n");
      out.write("                    staffCurrentUserType = userType;\r\n");
      out.write("                    \r\n");
      out.write("                    if (userType === 'STAFF') {\r\n");
      out.write("                        connectStaffChat();\r\n");
      out.write("                        loadCustomerList();\r\n");
      out.write("                    }\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                // Kết nối WebSocket cho staff\r\n");
      out.write("                function connectStaffChat() {\r\n");
      out.write("                    const statusElement = document.getElementById('staff-connection-status');\r\n");
      out.write("                    statusElement.textContent = 'Đang kết nối...';\r\n");
      out.write("                    statusElement.className = 'badge bg-warning';\r\n");
      out.write("                    \r\n");
      out.write("                    console.log('🔌 Connecting staff chat WebSocket for user:', staffCurrentUserId);\r\n");
      out.write("                    \r\n");
      out.write("                    const socket = new SockJS('/ws-chat');\r\n");
      out.write("                    staffStompClient = Stomp.over(socket);\r\n");
      out.write("                    \r\n");
      out.write("                    staffStompClient.connect({}, function(frame) {\r\n");
      out.write("                        console.log('✅ Staff chat connected:', frame);\r\n");
      out.write("                        \r\n");
      out.write("                        // Subscribe để nhận tin nhắn\r\n");
      out.write("                        const subscriptionUrl = '/user/' + staffCurrentUserId + '/queue/messages';\r\n");
      out.write("                        console.log('📡 Subscribing to:', subscriptionUrl);\r\n");
      out.write("                        \r\n");
      out.write("                        staffStompClient.subscribe(subscriptionUrl, function(message) {\r\n");
      out.write("                            console.log('📩 Staff received message:', message.body);\r\n");
      out.write("                            const messageData = JSON.parse(message.body);\r\n");
      out.write("                            handleStaffIncomingMessage(messageData);\r\n");
      out.write("                        });\r\n");
      out.write("                        \r\n");
      out.write("                        // Cập nhật trạng thái kết nối\r\n");
      out.write("                        statusElement.textContent = 'Đã kết nối';\r\n");
      out.write("                        statusElement.className = 'badge bg-success';\r\n");
      out.write("                        \r\n");
      out.write("                        // Enable input nếu đã chọn customer\r\n");
      out.write("                        if (selectedCustomerId) {\r\n");
      out.write("                            enableStaffInput();\r\n");
      out.write("                        }\r\n");
      out.write("                        \r\n");
      out.write("                    }, function(error) {\r\n");
      out.write("                        console.error('❌ Staff chat connection error:', error);\r\n");
      out.write("                        statusElement.textContent = 'Mất kết nối';\r\n");
      out.write("                        statusElement.className = 'badge bg-danger';\r\n");
      out.write("                    });\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                // Load danh sách customer\r\n");
      out.write("                function loadCustomerList() {\r\n");
      out.write("                    console.log('🔍 Loading customer list...');\r\n");
      out.write("                    fetch('/api/chat/customers')\r\n");
      out.write("                        .then(response => {\r\n");
      out.write("                            console.log('📡 Customer API response status:', response.status);\r\n");
      out.write("                            return response.json();\r\n");
      out.write("                        })\r\n");
      out.write("                        .then(customers => {\r\n");
      out.write("                            console.log('👥 Customers received:', customers);\r\n");
      out.write("                            customerListData = customers;\r\n");
      out.write("                            displayCustomerList(customers);\r\n");
      out.write("                        })\r\n");
      out.write("                        .catch(error => {\r\n");
      out.write("                            console.error('❌ Error loading customers:', error);\r\n");
      out.write("                            document.getElementById('customer-list').innerHTML = `\r\n");
      out.write("                                <div class=\"text-center p-3 text-danger\">\r\n");
      out.write("                                    <i class=\"fas fa-exclamation-triangle fa-2x mb-2\"></i>\r\n");
      out.write("                                    <p>Không thể tải danh sách khách hàng</p>\r\n");
      out.write("                                    <small>Error: ");
      out.write((java.lang.String) org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate("${error.message}", java.lang.String.class, (jakarta.servlet.jsp.PageContext)_jspx_page_context, null));
      out.write("</small>\r\n");
      out.write("                                </div>\r\n");
      out.write("                            `;\r\n");
      out.write("                        });\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                // Hiển thị danh sách customer\r\n");
      out.write("                function displayCustomerList(customers) {\r\n");
      out.write("                    const listContainer = document.getElementById('customer-list');\r\n");
      out.write("                    \r\n");
      out.write("                    if (customers.length === 0) {\r\n");
      out.write("                        listContainer.innerHTML = `\r\n");
      out.write("                            <div class=\"text-center p-3 text-muted\">\r\n");
      out.write("                                <i class=\"fas fa-users fa-2x mb-2\"></i>\r\n");
      out.write("                                <p>Chưa có khách hàng nào</p>\r\n");
      out.write("                            </div>\r\n");
      out.write("                        `;\r\n");
      out.write("                        return;\r\n");
      out.write("                    }\r\n");
      out.write("                    \r\n");
      out.write("                    listContainer.innerHTML = customers.map(customer => \r\n");
      out.write("                        '<div class=\"customer-item\" onclick=\"selectCustomer(' + customer.id + ', \\'' + customer.fullName + '\\', \\'' + customer.email + '\\')\">' +\r\n");
      out.write("                            '<div class=\"customer-avatar\">' +\r\n");
      out.write("                                '<i class=\"fas fa-user\"></i>' +\r\n");
      out.write("                            '</div>' +\r\n");
      out.write("                            '<div class=\"customer-info\">' +\r\n");
      out.write("                                '<h6>' + customer.fullName + '</h6>' +\r\n");
      out.write("                                '<small class=\"text-muted\">' + customer.email + '</small>' +\r\n");
      out.write("                            '</div>' +\r\n");
      out.write("                        '</div>'\r\n");
      out.write("                    ).join('');\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                // Chọn customer để chat\r\n");
      out.write("                function selectCustomer(customerId, customerName, customerEmail) {\r\n");
      out.write("                    // Remove active class from all items\r\n");
      out.write("                    document.querySelectorAll('.customer-item').forEach(item => {\r\n");
      out.write("                        item.classList.remove('active');\r\n");
      out.write("                    });\r\n");
      out.write("                    \r\n");
      out.write("                    // Add active class to selected item\r\n");
      out.write("                    event.currentTarget.classList.add('active');\r\n");
      out.write("                    \r\n");
      out.write("                    selectedCustomerId = customerId;\r\n");
      out.write("                    \r\n");
      out.write("                    // Update chat header\r\n");
      out.write("                    document.getElementById('selected-customer-name').textContent = customerName;\r\n");
      out.write("                    document.getElementById('selected-customer-email').textContent = customerEmail;\r\n");
      out.write("                    document.getElementById('chat-header').style.display = 'flex';\r\n");
      out.write("                    document.getElementById('staff-chat-input').style.display = 'block';\r\n");
      out.write("                    \r\n");
      out.write("                    // Clear messages and load history\r\n");
      out.write("                    const messagesContainer = document.getElementById('staff-chat-messages');\r\n");
      out.write("                    messagesContainer.innerHTML = '';\r\n");
      out.write("                    \r\n");
      out.write("                    // Enable input if connected\r\n");
      out.write("                    if (staffStompClient && staffStompClient.connected) {\r\n");
      out.write("                        enableStaffInput();\r\n");
      out.write("                    }\r\n");
      out.write("                    \r\n");
      out.write("                    // Load chat history for this customer (from any staff)\r\n");
      out.write("                    loadCustomerChatHistory(customerId);\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                // Load lịch sử chat của customer với bất kỳ staff nào\r\n");
      out.write("                function loadCustomerChatHistory(customerId) {\r\n");
      out.write("                    console.log('📚 Loading chat history for customer:', customerId);\r\n");
      out.write("                    fetch('/api/chat/customer-messages/' + customerId)\r\n");
      out.write("                        .then(response => response.json())\r\n");
      out.write("                        .then(messages => {\r\n");
      out.write("                            console.log('📝 Customer chat history loaded:', messages.length, 'messages');\r\n");
      out.write("                            messages.forEach(message => {\r\n");
      out.write("                                displayStaffMessage(message, false);\r\n");
      out.write("                            });\r\n");
      out.write("                            scrollStaffChatToBottom();\r\n");
      out.write("                        })\r\n");
      out.write("                        .catch(error => {\r\n");
      out.write("                            console.error('❌ Error loading customer chat history:', error);\r\n");
      out.write("                        });\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                // Hiển thị tin nhắn trong staff chat\r\n");
      out.write("                function displayStaffMessage(message, isNew = true) {\r\n");
      out.write("                    const messagesContainer = document.getElementById('staff-chat-messages');\r\n");
      out.write("                    const messageWrapper = document.createElement('div');\r\n");
      out.write("                    messageWrapper.style.width = '100%';\r\n");
      out.write("                    messageWrapper.style.marginBottom = '10px';\r\n");
      out.write("                    messageWrapper.style.display = 'block';\r\n");
      out.write("                    \r\n");
      out.write("                    const messageDiv = document.createElement('div');\r\n");
      out.write("                    \r\n");
      out.write("                    const isSent = message.senderId == staffCurrentUserId;\r\n");
      out.write("                    messageDiv.className = 'staff-message ' + (isSent ? 'sent' : 'received');\r\n");
      out.write("                    \r\n");
      out.write("                    const avatar = isSent ? `\r\n");
      out.write("                        <div class=\"customer-avatar\" style=\"background: #28a745;\">\r\n");
      out.write("                            <i class=\"fas fa-user-tie\"></i>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    ` : `\r\n");
      out.write("                        <div class=\"customer-avatar\">\r\n");
      out.write("                            <i class=\"fas fa-user\"></i>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    `;\r\n");
      out.write("                    \r\n");
      out.write("                    // Escape HTML và xử lý text properly\r\n");
      out.write("                    const messageText = escapeStaffHtml(message.message);\r\n");
      out.write("                    const formattedTime = new Date(message.timestamp).toLocaleTimeString('vi-VN', {\r\n");
      out.write("                        hour: '2-digit',\r\n");
      out.write("                        minute: '2-digit'\r\n");
      out.write("                    });\r\n");
      out.write("                    \r\n");
      out.write("                    messageDiv.innerHTML = `\r\n");
      out.write("                        ` + avatar + `\r\n");
      out.write("                        <div>\r\n");
      out.write("                            <div class=\"message-bubble\">\r\n");
      out.write("                                <div style=\"word-break: break-word; overflow-wrap: break-word; hyphens: none;\">` + messageText + `</div>\r\n");
      out.write("                            </div>\r\n");
      out.write("                            <div class=\"message-time\">\r\n");
      out.write("                                ` + formattedTime + `\r\n");
      out.write("                                ` + (isSent && message.isRead ? ' ✓✓' : '') + `\r\n");
      out.write("                            </div>\r\n");
      out.write("                        </div>\r\n");
      out.write("                    `;\r\n");
      out.write("                    \r\n");
      out.write("                    messageWrapper.appendChild(messageDiv);\r\n");
      out.write("                    messagesContainer.appendChild(messageWrapper);\r\n");
      out.write("                    \r\n");
      out.write("                    if (isNew) {\r\n");
      out.write("                        scrollStaffChatToBottom();\r\n");
      out.write("                    }\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                // Helper function để escape HTML cho staff\r\n");
      out.write("                function escapeStaffHtml(unsafe) {\r\n");
      out.write("                    if (!unsafe) return '';\r\n");
      out.write("                    return unsafe\r\n");
      out.write("                        .replace(/&/g, \"&amp;\")\r\n");
      out.write("                        .replace(/</g, \"&lt;\")\r\n");
      out.write("                        .replace(/>/g, \"&gt;\")\r\n");
      out.write("                        .replace(/\"/g, \"&quot;\")\r\n");
      out.write("                        .replace(/'/g, \"&#039;\");\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                // Gửi tin nhắn từ staff\r\n");
      out.write("                function sendStaffMessage() {\r\n");
      out.write("                    const input = document.getElementById('staff-message-input');\r\n");
      out.write("                    const message = input.value.trim();\r\n");
      out.write("                    \r\n");
      out.write("                    if (message && staffStompClient && selectedCustomerId) {\r\n");
      out.write("                        const messageData = {\r\n");
      out.write("                            senderId: staffCurrentUserId,\r\n");
      out.write("                            receiverId: selectedCustomerId,\r\n");
      out.write("                            message: message,\r\n");
      out.write("                            senderType: 'STAFF',\r\n");
      out.write("                            receiverType: 'CUSTOMER'\r\n");
      out.write("                        };\r\n");
      out.write("                        \r\n");
      out.write("                        // Temporarily disable button và clear input\r\n");
      out.write("                        const sendButton = document.getElementById('staff-send-button');\r\n");
      out.write("                        sendButton.disabled = true;\r\n");
      out.write("                        input.value = '';\r\n");
      out.write("                        \r\n");
      out.write("                        staffStompClient.send(\"/app/chat.sendMessage\", {}, JSON.stringify(messageData));\r\n");
      out.write("                        \r\n");
      out.write("                        // Hiển thị tin nhắn vừa gửi lên UI ngay lập tức\r\n");
      out.write("                        displayStaffMessage({\r\n");
      out.write("                            senderId: staffCurrentUserId,\r\n");
      out.write("                            message: message,\r\n");
      out.write("                            timestamp: new Date()\r\n");
      out.write("                        }, true);\r\n");
      out.write("                        \r\n");
      out.write("                        // Re-enable button sau 1 giây\r\n");
      out.write("                        setTimeout(() => {\r\n");
      out.write("                            sendButton.disabled = false;\r\n");
      out.write("                        }, 1000);\r\n");
      out.write("                    }\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                // Xử lý tin nhắn đến cho staff\r\n");
      out.write("                function handleStaffIncomingMessage(messageData) {\r\n");
      out.write("                    // Nếu đang chat với customer này, hiển thị tin nhắn\r\n");
      out.write("                    if (selectedCustomerId && messageData.senderId == selectedCustomerId) {\r\n");
      out.write("                        displayStaffMessage(messageData);\r\n");
      out.write("                    }\r\n");
      out.write("                    \r\n");
      out.write("                    // Update notification badge if needed\r\n");
      out.write("                    // This could be enhanced to show unread count per customer\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                // Enable staff input\r\n");
      out.write("                function enableStaffInput() {\r\n");
      out.write("                    document.getElementById('staff-message-input').disabled = false;\r\n");
      out.write("                    document.getElementById('staff-send-button').disabled = false;\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                // Refresh customer list\r\n");
      out.write("                function refreshCustomerList() {\r\n");
      out.write("                    loadCustomerList();\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                // Scroll to bottom\r\n");
      out.write("                function scrollStaffChatToBottom() {\r\n");
      out.write("                    const messagesContainer = document.getElementById('staff-chat-messages');\r\n");
      out.write("                    if (messagesContainer) {\r\n");
      out.write("                        const scrollHeight = messagesContainer.scrollHeight;\r\n");
      out.write("                        const height = messagesContainer.clientHeight;\r\n");
      out.write("                        const maxScrollTop = scrollHeight - height;\r\n");
      out.write("                        \r\n");
      out.write("                        // Smooth scroll animation\r\n");
      out.write("                        messagesContainer.scrollTo({\r\n");
      out.write("                            top: maxScrollTop,\r\n");
      out.write("                            behavior: 'smooth'\r\n");
      out.write("                        });\r\n");
      out.write("                        \r\n");
      out.write("                        // Fallback for older browsers\r\n");
      out.write("                        setTimeout(() => {\r\n");
      out.write("                            messagesContainer.scrollTop = maxScrollTop;\r\n");
      out.write("                        }, 100);\r\n");
      out.write("                    }\r\n");
      out.write("                }\r\n");
      out.write("\r\n");
      out.write("                // Search customers\r\n");
      out.write("                document.addEventListener('DOMContentLoaded', function() {\r\n");
      out.write("                    const searchInput = document.getElementById('customer-search');\r\n");
      out.write("                    if (searchInput) {\r\n");
      out.write("                        searchInput.addEventListener('input', function(e) {\r\n");
      out.write("                            const searchTerm = e.target.value.toLowerCase();\r\n");
      out.write("                            const filteredCustomers = customerListData.filter(customer => \r\n");
      out.write("                                customer.fullName.toLowerCase().includes(searchTerm) ||\r\n");
      out.write("                                customer.email.toLowerCase().includes(searchTerm)\r\n");
      out.write("                            );\r\n");
      out.write("                            displayCustomerList(filteredCustomers);\r\n");
      out.write("                        });\r\n");
      out.write("                    }\r\n");
      out.write("                    \r\n");
      out.write("                    // Enter to send message\r\n");
      out.write("                    const messageInput = document.getElementById('staff-message-input');\r\n");
      out.write("                    if (messageInput) {\r\n");
      out.write("                        messageInput.addEventListener('keypress', function(e) {\r\n");
      out.write("                            if (e.key === 'Enter') {\r\n");
      out.write("                                sendStaffMessage();\r\n");
      out.write("                            }\r\n");
      out.write("                        });\r\n");
      out.write("                    }\r\n");
      out.write("                });\r\n");
      out.write("                </script>\r\n");
      out.write("\r\n");
      out.write("                <script>\r\n");
      out.write("                    // Check staff access on page load and initialize chat\r\n");
      out.write("                    document.addEventListener('DOMContentLoaded', function () {\r\n");
      out.write("                        checkPageAccess('STAFF');\r\n");
      out.write("                        \r\n");
      out.write("                        // Initialize staff chat with Staff Member (ID: 8) from session\r\n");
      out.write("                        console.log('🔍 Initializing staff chat for logged in staff...');\r\n");
      out.write("                        \r\n");
      out.write("                        // Staff info from login session: Staff Member (staff@gundam.com) - ID: 8\r\n");
      out.write("                        const staffUserId = 8; // Staff Member ID from database\r\n");
      out.write("                        const staffUserType = 'STAFF';\r\n");
      out.write("                        \r\n");
      out.write("                        // Set sessionStorage for consistency\r\n");
      out.write("                        sessionStorage.setItem('userId', staffUserId.toString());\r\n");
      out.write("                        sessionStorage.setItem('userType', staffUserType);\r\n");
      out.write("                        sessionStorage.setItem('userName', 'Staff Member');\r\n");
      out.write("                        sessionStorage.setItem('userEmail', 'staff@gundam.com');\r\n");
      out.write("                        \r\n");
      out.write("                        console.log('✅ Staff session set:', {\r\n");
      out.write("                            userId: staffUserId,\r\n");
      out.write("                            userType: staffUserType,\r\n");
      out.write("                            userName: 'Staff Member',\r\n");
      out.write("                            userEmail: 'staff@gundam.com'\r\n");
      out.write("                        });\r\n");
      out.write("                        \r\n");
      out.write("                        // Initialize staff chat\r\n");
      out.write("                        initStaffChat(staffUserId, staffUserType);\r\n");
      out.write("                        console.log('✅ Staff chat initialized with ID:', staffUserId);\r\n");
      out.write("                    });\r\n");
      out.write("                </script>\r\n");
      out.write("    </body>\r\n");
      out.write("\r\n");
      out.write("    </html>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof jakarta.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try {
            if (response.isCommitted()) {
              out.flush();
            } else {
              out.clearBuffer();
            }
          } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
